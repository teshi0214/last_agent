# 任意の作業ディレクトリに移動
cd ~/work

# リポジトリをクローン
git clone https://github.com/teshi0214/last_agent.git
cd good_agent

# 仮想環境を作成 & 有効化
python3 -m venv .venv
source .venv/bin/activate

# 必要ライブラリをインストール
pip install -r requirements.txt

.env ファイルをリポジトリ直下に作成（または環境変数で渡す）
GOOGLE_CLOUD_PROJECT=good-agent-project
GOOGLE_CLOUD_LOCATION=us-central1
GOOGLE_CLOUD_STORAGE_BUCKET=good-agent-bucket
SERPAPI_API_KEY=xxxxxx   # SecretManagerで読むなら不要

GOOGLE_CLOUD_PROJECT=original-circle-471513-j7
GOOGLE_CLOUD_LOCATION=us-central1
STAGING_BUCKET=gs://agent-test-0911
GOOGLE_GENAI_USE_VERTEXAI="True"
SERPAPI_API_KEY=


python google_scholar_02/deploy.py \
  --create \
  --project_id=good-agent-project \
  --location=us-central1 \
  --bucket=good-agent-bucket

GCP/ADK関連
	•	google-adk>=0.0.2,<2.0.0
	•	google-cloud-aiplatform[agent_engines,adk]>=1.111.0
	•	google-genai>=1.5.0,<2.0.0

Pythonユーティリティ
	•	pydantic>=2.10.6,<3.0.0
	•	absl-py>=2.2.1,<3.0.0
	•	cloudpickle==3.1.1

Webスクレイピング/データ処理（Google Scholar向け）
	•	beautifulsoup4>=4.12.0,<5.0.0
	•	lxml>=4.9.0,<6.0.0
	•	requests>=2.31.0,<3.0.0
	•	pandas>=2.0.0,<3.0.0

環境変数管理
	•	python-dotenv


pip install \
  google-adk \
  "google-cloud-aiplatform[agent_engines,adk]" \
  google-genai \
  pydantic \
  absl-py \
  cloudpickle==3.1.1 \
  beautifulsoup4 \
  lxml \
  requests \
  pandas \
  python-dotenv ¥
  absl-py
python-dotenv

	2.	ログイン & プロジェクト設定
gcloud auth login
gcloud auth application-default login   # ← ADC（クライアントライブラリ用）
gcloud config set project <PROJECT_ID>
gcloud config set ai/region <REGION>    # 例: us-central1


API
gcloud services enable \
  aiplatform.googleapis.com \
  storage.googleapis.com \
  logging.googleapis.com

	5.	GCSバケット（リージョンは Vertex と合わせる）
gcloud storage buckets create gs://<BUCKET_NAME> --location=<REGION>

python google_scholar_02/deploy.py --create



	2.	ロール付与（プロジェクト）
gcloud projects add-iam-policy-binding <PROJECT_ID> \
  --member="serviceAccount:deploy-agent@<PROJECT_ID>.iam.gserviceaccount.com" \
  --role="roles/aiplatform.admin"

gcloud projects add-iam-policy-binding <PROJECT_ID> \
  --member="serviceAccount:deploy-agent@<PROJECT_ID>.iam.gserviceaccount.com" \
  --role="roles/logging.viewer"

	3.	ロール付与（バケット）
gcloud iam service-accounts keys create sa-key.json \
  --iam-account=deploy-agent@<PROJECT_ID>.iam.gserviceaccount.com
export GOOGLE_APPLICATION_CREDENTIALS="$PWD/sa-key.json"


	4.	キーファイル発行（ローカル/CIで使う場合）
gcloud iam service-accounts keys create sa-key.json \
  --iam-account=deploy-agent@<PROJECT_ID>.iam.gserviceaccount.com
export GOOGLE_APPLICATION_CREDENTIALS="$PWD/sa-key.json"

	5.	デプロイ実行
python google_scholar_02/deploy.py \
  --create \
  --project_id=<PROJECT_ID> \
  --location=<REGION> \
  --bucket=<BUCKET_NAME>



python google_scholar_02/deploy.py \
  --create \
  --project_id=original-circle-471513-j7 \
  --location=us-central1 \
  --bucket=agent-test-0911
